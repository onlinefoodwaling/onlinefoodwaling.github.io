var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,n,k){a!=Array.prototype&&a!=Object.prototype&&(a[n]=k.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var n=0;return $jscomp.iteratorPrototype(function(){return n<a.length?{done:!1,value:a[n++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,n){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var k=0,b={next:function(){if(k<a.length){var c=k++;return{value:n(c,a[c]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill=function(a,n,k,b){if(n){k=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var c=a[b];c in k||(k[c]={});k=k[c]}a=a[a.length-1];b=k[a];n=n(b);n!=b&&null!=n&&$jscomp.defineProperty(k,a,{configurable:!0,writable:!0,value:n})}};$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,k){return k})}},"es6","es3");
$jscomp.findInternal=function(a,n,k){a instanceof String&&(a=String(a));for(var b=a.length,c=0;c<b;c++){var r=a[c];if(n.call(k,r,c,a))return{i:c,v:r}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,k){return $jscomp.findInternal(this,a,k).v}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
(function(a){var n=function(b,c){this.$table=a(b);this.top=window.top.document;this.init(c)};n.prototype={$table:null,app:null,init:function(b){this.app=b;this.loadExtraFields(b.values);this.makeSortable();this.events()},loadOrders:function(b,c){try{var a=JSON.parse(b.field_order)}catch(v){}a||(a={});for(var d=this.$table[0].getElementsByTagName("tbody")[0],l=d.getElementsByTagName("tr"),h=[],g=document.createDocumentFragment(),k,e=0,p=l.length;e<p;++e)l[e].classList.contains("tb_no_sort")?k=l[e]:
h.push(l[e]);l=null;h.sort(function(b,d){var r=function(b){for(var a=c.length-1;-1<a;--a)if((c[a].label===b||c[a].id===b)&&void 0!==c[a].order)return c[a].order;return!1};var g=b.classList.contains("tb_contact_new_row");var h=d.classList.contains("tb_contact_new_row");if(g){var e=b.getElementsByClassName("tb_new_field_textbox")[0].value;e=""===e?b.getElementsByClassName("tb_new_field_textbox")[0].dataset.id:e}else e=b.getElementsByClassName("tb_lb_option")[0].id;if(h){var f=d.getElementsByClassName("tb_new_field_textbox")[0].value;
f=""===f?b.getElementsByClassName("tb_new_field_textbox")[0].dataset.id:f}else f=d.getElementsByClassName("tb_lb_option")[0].id;e=e.trim();f=f.trim();e=void 0!==a[e]?a[e]:g?r(e):!1;f=void 0!==a[f]?a[f]:h?r(f):!1;return e-f});e=0;for(p=h.length;e<p;++e)g.appendChild(h[e]);for(g.appendChild(k);d.firstChild;)d.removeChild(d.firstChild);d.appendChild(g)},loadExtraFields:function(b){var c=this.$table[0].getElementsByClassName("tb_no_sort")[0];try{var a=JSON.parse(b.field_extra).fields}catch(g){}a||(a=
{fields:[]});for(var d=document.createDocumentFragment(),l=0,h=a.length;l<h;++l)d.appendChild(this.addField(a[l]));c.parentNode.insertBefore(d,c);this.loadOrders(b,a)},events:function(){var b=this;this.$table.on("click.tb_contact",".tb_new_field_action",function(a){a.preventDefault();a.stopPropagation();a=this.closest(".tb_no_sort");a.parentNode.insertBefore(b.addField({}),a);b.$table.find("tbody").sortable("refresh");b.changeObject()}).on("change.tb_contact",".tb_new_field_type",function(){b.switchField(this);
b.changeObject()}).on("click.tb_contact",".tb_add_field_option",function(a){a.preventDefault();a.stopPropagation();this.previousElementSibling.appendChild(b.render.getOptions([""]))}).on("keyup.tb_contact",'.tb_contact_new_row input[type="text"], .tb_contact_new_row textarea',function(){b.changeObject()}).on("change.tb_contact",".tb_contact_new_row .tb_new_field_required",function(){b.changeObject()}).on("click.tb_contact",".tb_contact_value_remove,.tb_contact_field_remove",function(c){c.preventDefault();
c.stopPropagation();this.classList.contains("tb_contact_value_remove")?a(this).closest("li").remove():a(this).closest(".tb_contact_new_row").remove();b.changeObject()})},makeSortable:function(){var b=this;this.$table.find("tbody").sortable({items:"tr:not(.tb_no_sort)",placeholder:"ui-state-highlight",axis:"y",containment:"parent",update:function(){b.changeObject()}})},render:{call:function(b,a){return void 0===this[a]?this._default(b,a):this[a].call(this,b,a)},setType:function(b,a){b.setAttribute("data-type",
a)},getText:function(b,a,r){var c=document.createElement(r);"textarea"!==r&&(c.type="tel"!==r?"text":"tel");b.value&&(c.value=b.value);c.className="tb_new_field_value tb_field_type_text";this.setType(c,a);return c},"static":function(b,a){var c=this._default(b,"textarea");c.placeholder=tb_contact_l10n.static_text;this.setType(c,"static");return c},upload:function(a,c){return document.createElement("div")},getOptions:function(a){var b=document.createDocumentFragment(),r;for(r in a){var d=document.createElement("li"),
l=document.createElement("a"),h=document.createElement("input"),g=document.createElement("i");h.type="text";h.className="tb_multi_option";h.value=a[r];l.className="tb_contact_value_remove";l.href="#";g.className="ti ti-close";d.appendChild(h);l.appendChild(g);d.appendChild(l);b.appendChild(d)}return b},_default:function(a,c){if("text"===c||"textarea"===c||"tel"===c)return this.getText(a,c,"textarea"===c?c:"input");var b=document.createElement("ul"),d=document.createElement("a"),l=document.createDocumentFragment();
b.appendChild(this.getOptions(a.value||[""]));l.appendChild(b);d.href="#";d.className="tb_add_field_option";d.textContent=tb_contact_l10n.add_option;this.setType(d,c);l.appendChild(d);return l}},addField:function(a){var b=0===Object.keys(a).length,r=a.type?a.type:"text",d=document.createElement("tr"),l=document.createElement("td"),h=document.createElement("input"),g=document.createElement("td"),k=document.createElement("div"),e=document.createElement("select"),p=document.createDocumentFragment(),
n=document.createElement("div"),w=document.createElement("div"),m=document.createElement("label"),q=document.createElement("input"),t=document.createElement("a"),u=document.createElement("i"),f=tb_contact_l10n.types,x="tb_"+tb_app.Utils.generateUniqueID();n.className="control-input";w.className="tb_new_field";k.className="selectwrapper";e.className="tb_new_field_type tb_lb_option";d.className="tb_contact_new_row";h.type="text";h.className="tb_new_field_textbox";h.value=void 0===a.label?!0===b?tb_contact_l10n.field_name:
"":a.label;h.dataset.id=void 0===a.id?"":a.id;q.type="checkbox";q.className="tb_new_field_required";q.value="required";"static"===r&&(m.style.display="none");!0===a.required&&(q.checked=!0);t.className="tb_contact_field_remove";t.href="#";u.className="ti ti-close";g.setAttribute("colspan","3");l.appendChild(h);d.appendChild(l);for(var z in f)b=document.createElement("option"),b.name=x,z===r&&(b.selected="selected"),b.value=z,b.textContent=f[z],p.appendChild(b);e.appendChild(p);k.appendChild(e);g.appendChild(k);
n.appendChild(this.render.call(a,r));w.appendChild(n);m.appendChild(q);m.appendChild(document.createTextNode(tb_contact_l10n.req));w.appendChild(m);g.appendChild(w);t.appendChild(u);g.appendChild(t);d.appendChild(g);return d},switchField:function(a){var b=a.value;a=a.closest("td").getElementsByClassName("control-input")[0];for(var k=a.closest(".tb_new_field").getElementsByClassName("tb_new_field_required")[0].parentNode;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(this.render.call({},b));
k.style.display="static"===b?"none":""},changeObject:function(){for(var a=this.$table[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr"),c={fields:[]},k={},d=0,l=a.length;d<l;++d)if(a[d].classList.contains("tb_contact_new_row")){var h=a[d].getElementsByClassName("tb_new_field_type")[0].options[a[d].getElementsByClassName("tb_new_field_type")[0].selectedIndex].value,g=a[d].getElementsByClassName("tb_new_field_textbox")[0].value.trim(),n="static"!==h&&!0===a[d].getElementsByClassName("tb_new_field_required")[0].checked;
switch(h){case "text":case "textarea":case "static":case "tel":var e=a[d].getElementsByClassName("tb_new_field_value")[0].value.trim();break;case "radio":case "select":case "checkbox":e=[];for(var p=a[d].getElementsByClassName("control-input")[0].getElementsByTagName("input"),v=0,w=p.length;v<w;++v){var m=p[v].value.trim();""!==m&&e.push(m)}}if(""!==e&&void 0!==e||""!==g)h={type:h,order:d},n&&(h.required=n),""!==g?h.label=g:h.id="ex"+d,void 0!==e&&""!==e&&0<e.length&&(h.value=e),c.fields.push(h)}else a[d].classList.contains("tb_no_sort")||
(g=a[d].getElementsByClassName("tb_lb_option")[0].id,k[g]=d);a=this.top.getElementById("field_extra");a.value=JSON.stringify(c);c=JSON.stringify(k);this.top.getElementById("field_order").value=c;this.app.settings.field_order=c;Themify.triggerEvent(a,"change")}};var k=null;tb_app.Constructor.contact_fields={render:function(a,c){var b=window.top;null===k&&(k=!0,b.Themify.LoadCss(tb_contact_l10n.admin_css,tb_contact_l10n.v));var d=document.createElement("table"),b=document.createElement("thead"),l=document.createElement("tbody"),
h=document.createElement("tfoot"),g=document.createElement("tr"),y=document.createDocumentFragment(),e=a.options.head,p=a.options.body,v=a.options.foot,w={text:function(a,b,d){a={id:"field_"+a,placeholder:b,"class":"large",type:"text"};d&&(a.help=d);return c.create([a])},checkbox:function(a){return c.create([{id:"field_"+a,new_line:!0,type:"checkbox",options:[{value:"",name:"yes"}]}])}},m;for(m in e){var q=document.createElement("th");q.textContent=e[m];y.appendChild(q)}g.appendChild(y);b.appendChild(g);
y=document.createDocumentFragment();for(m in p){var t=document.createDocumentFragment();var g=document.createElement("tr"),u;for(u in e){q=document.createElement("td");var f=null;if("f"===u)f=document.createElement("span"),q.textContent=p[m];else if("l"===u||"p"===u){if(f=m+"_",f+="l"===u?"label":"placeholder",f=w.text(f,"l"===u?p[m]:e.p),"l"===u&&"message"!==m){var x=document.createDocumentFragment();var z=w.checkbox(m+"_require");x.appendChild(f);z.querySelector(".tb_lb_option").appendChild(document.createTextNode(tb_contact_l10n.req));
x.appendChild(z);f=x}}else"sh"===u&&(f=w.checkbox(m+"_active"));null!==f&&q.appendChild(f);t.appendChild(q)}g.appendChild(t);y.appendChild(g)}g=document.createElement("tr");q=document.createElement("td");t=document.createElement("a");p=document.createElement("span");t.className="tb_new_field_action";t.href="#";p.className="ti-plus";t.appendChild(p);t.appendChild(document.createTextNode(a.new_row));q.setAttribute("colspan","4");q.appendChild(t);g.className="tb_no_sort";g.appendChild(q);y.appendChild(g);
l.appendChild(y);for(m in v)if("align"!==m){t=document.createDocumentFragment();g=document.createElement("tr");for(u in e){q=document.createElement("td");f=null;if("f"===u)q.textContent=v[m];else if("l"===u){p=w.text(m+"_label",v[m]);if("send"===m)x=document.createDocumentFragment(),f=c.select.render({id:v.align.id,options:v.align.options},c),x.appendChild(p),x.appendChild(f),x.appendChild(document.createTextNode(v.align.label)),f=x;else if("optin"===m){f=document.createDocumentFragment();var B=ThemifyConstructor.create([{type:"optin_provider",
id:"optin"}]);f.appendChild(p);f.appendChild(B)}else f=p;x.appendChild(z)}else"sh"===u&&"send"!==m&&(f=w.checkbox(m+"_active"),console.log(tb_contact_l10n.captcha),"captcha"===m&&""!==tb_contact_l10n.captcha&&f.querySelector("input").addEventListener("change",function(a){a=this.closest("td").previousElementSibling;if(!0===this.checked){var b=document.createElement("div");b.className="tb_captcha_message tb_field_error_msg";b.innerHTML=tb_contact_l10n.captcha;a.appendChild(b)}else a=a.getElementsByClassName("tb_captcha_message")[0],
a.parentNode.removeChild(a)},{passive:!0}));null!==f&&q.appendChild(f);t.appendChild(q)}g.appendChild(t);y.appendChild(g)}h.appendChild(y);d.className="contact_fields";d.appendChild(b);d.appendChild(l);d.appendChild(h);var e=g=b=l=h=p=v=null,A=function(a){var b=new n(d,c);Themify.body.one("themify_builder_lightbox_close",function(a){b.$table.off("click.tb_contact keyup.tb_contact change.tb_contact");b=null});document.removeEventListener("tb_editing_contact",A,{once:!0})};document.addEventListener("tb_editing_contact",
A,{once:!0});return d}}})(jQuery);
